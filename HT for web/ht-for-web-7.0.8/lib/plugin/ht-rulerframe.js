!function(H,T){"use strict";var v="position",$="absolute",R="relative",B="px",I="left",w="right",E="top",X="bottom",F="display",q="none",t="block",s=ht.Default,U=s.getInternal(),N=Math.floor,m=Math.ceil,k=Math.PI,p=null,K=H.parseInt,O=function(b){return b.getContext("2d")},r=function(){return document},y=function(b){return r().createElement(b)},g=function(){return y("canvas")},C=function($,Y,y){$.style.setProperty(Y,y,p)},J=function(P,k,g){s.def(ht.widget[P],k,g)},b=function(B,D){B.appendChild(D)},W=function(l,A){l.removeChild(A)},U=s.getInternal(),S=U.addEventListener,o=U.removeEventListener;ht.widget.RulerFrame=function(u){var Y=this,P=Y._view=U.createView(null,Y),e=Y.$1k=g(),Q=Y.$2k=g(),s=Y.$3k=g(),S=Y.$4k=g();Y._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},Y._topRulerConfig={visible:!0},Y._rightRulerConfig={visible:!1},Y._bottomRulerConfig={visible:!1},Y._leftRulerConfig={visible:!0},b(P,e),b(P,s),b(P,Q),b(P,S),C(P,v,R),C(P,"box-sizing","border-box"),C(P,"-moz-box-sizing","border-box"),C(e,v,$),C(Q,v,$),C(s,v,$),C(S,v,$),Y.$14k=function(){Y.$13k=1,Y.iv()},Y.$15k=function(h){if(Y._topRulerConfig.guideVisible||Y._rightRulerConfig.guideVisible||Y._bottomRulerConfig.guideVisible||Y._leftRulerConfig.guideVisible||Y._defaultRulerConfig.guideVisible||(Y._topRulerConfig.guideTipVisible||Y._rightRulerConfig.guideTipVisible||Y._bottomRulerConfig.guideTipVisible||Y._leftRulerConfig.guideTipVisible||Y._defaultRulerConfig.guideTipVisible)&&Y._component){var e=P.getBoundingClientRect();Y.$16k={x:h.clientX-e.left,y:h.clientY-e.top},Y.$5k()}},Y.setComponent(u)},J("RulerFrame",T,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(L){var x=this,u=x._component,K=x.getView();if(K){if(x._component=L,x.fp("component",u,L),u){var m=x.getComponentView(u);W(K,m),o(K,"mousemove",x.$15k),x.removeComponentPropertyChangeListener(u,x.$14k)}if(L){var F=x.getComponentView(L);b(K,F),C(F,v,$),S(K,"mousemove",x.$15k),x.addComponentPropertyChangeListener(L,x.$14k)}}},addComponentPropertyChangeListener:function(L,J){L&&L.mp&&L.mp(J)},removeComponentPropertyChangeListener:function(n,S){n&&n.ump&&n.ump(S)},getComponentHZoom:function(s){return s&&s.getZoom?s.getZoom():1},getComponentVZoom:function(y){return y&&y.getZoom?y.getZoom():1},getComponentViewRect:function(l){return l&&l.getViewRect?l.getViewRect():void 0},getComponentView:function(D){return D&&D.getView?D.getView():D},invalidateComponent:function(c){c&&c.iv&&c.iv()},validateComponent:function(F){F&&F.validate&&F.validate()},$7k:function(P,M,V,E,$,b,K,v,i,T,S,H){if(M.visible){var R=this._defaultRulerConfig,Z="borderStyle",k="borderColor",X="borderWidth",Y="background",G=M[Z]||R[Z],h=M[k]||R[k],W=M[X]||R[X],A=M.size!=p?M.size:R.size,d=M[Y]||R[Y],g=A+W,y=this.$6k(W,G,h,P,V,$,g,K,v,i,T,S,H);C(P,$,"0px"),b?U.setCanvas(P,E-y,A):U.setCanvas(P,A,E-y),C(P,"background",d),C(P,F,t)}else C(P,F,q),C(this.getComponentView(this._component),$,"0px")},$6k:function(E,D,M,n,S,l,J,c,F,y,O,L,U){var o=0;return C(n,S,E+"px "+D+" "+M),C(this.getComponentView(this._component),l,J+B),c?(C(n,F,y+B),o+=y):C(n,F,"0px"),O?(C(n,L,U+B),o+=U):C(n,L,"0px"),o},validateImpl:function(){var M=this,P=M._component,c=M.$1k,u=M.$2k,Q=M.$3k,k=M.$4k,K=M._view,J=M._defaultRulerConfig,Z=M._topRulerConfig,s=M._rightRulerConfig,z=M._bottomRulerConfig,t=M._leftRulerConfig,h=J.size;if(K&&P){var R=Z.size!=p?Z.size:h,o=s.size!=p?s.size:h,N=z.size!=p?z.size:h,b=t.size!=p?t.size:h;M.$7k(c,Z,"border-bottom",K.offsetWidth,E,!0,t.visible,I,b,s.visible,w,o),M.$7k(u,s,"border-left",K.offsetHeight,w,!1,Z.visible,E,R,z.visible,X,N),M.$7k(Q,z,"border-top",K.offsetWidth,X,!0,t.visible,I,b,s.visible,w,o),M.$7k(k,t,"border-right",K.offsetHeight,I,!1,Z.visible,E,R,z.visible,X,N),M.$13k?delete M.$13k:M.invalidateComponent(P),M.validateComponent(P),M.$5k()}},$5k:function(){function N(W,N,l,C,D,o){if(N.visible){var j=O(W),v=N[e]||I,F=N[r]!=p?N[r]:G,q=N[k]||B,y=N[h]||b,Q=N.size!=p?N.size:c,Am=N[S]||i,Bo=N[Y]||f,lc=N[R]||A,Bi=N[P]!=p?N[P]:$,lm=N[L]!=p?N[L]:J,Tm=N[_]!=p?N[_]:x,ur=N[d]!=p?N[d]:z,Hq=N[V]!=p?N[V]:M,fs=N[n]!=p?N[n]:a,oj=N[T]||qp,nb=N[w]||wb;F&&(v=K[o]=K.$8k(K[o]||v,N[U]||Z,N[u]||t,C?E:g,Bo)),l.call(K,j,s,m,H,X,Q,C?E:g,v,q,y,D,Am,lc);var uh=K.$16k;(Bi||lm)&&uh&&(C?K.$9k(j,uh.x,Q,oj,nb,Bi,lm,Tm,ur,Hq,fs):K.$10k(j,uh.y,Q,oj,nb,Bi,lm,Tm,ur,Hq,fs,D))}}var K=this,y=K.$1k,q=K.$2k,Q=K.$3k,C=K.$4k,W=K._topRulerConfig,v=K._rightRulerConfig,F=K._bottomRulerConfig,D=K._leftRulerConfig,l=K._defaultRulerConfig,j=K._component,o=K.getComponentViewRect(j),E=K.getComponentHZoom(j),g=K.getComponentVZoom(j),s=o.x*E,H=s+o.width*E,m=o.y*g,X=m+o.height*g,c=K._defaultRulerConfig.size,e="defaultMajorTickSpacing",U="maxPhysicalMajorTickSpacing",u="minPhysicalMajorTickSpacing",r="tickSpacingAdaptable",k="majorTickTextFont",h="majorTickTextColor",S="majorTickColor",R="minorTickColor",P="guideVisible",L="guideTipVisible",_="guideTipBorderColor",d="guideTipTextColor",V="guideTipTextFont",n="guideTipBackground",T="guideColor",w="guideWidth",Y="minMajorTickSpacing",I=l[e],Z=l[U],t=l[u],G=l[r],B=l[k],b=l[h],i=l[S],f=l[Y],A=l[R],$=l[P],J=l[L],x=l[_],z=l[d],M=l[V],a=l[n],qp=l[T],wb=l[w];K._view&&j&&(N(y,W,K.$11k,!0,!1,"_currentTopMajorTickSpacing"),N(q,v,K.$12k,!1,!0,"_currentRightMajorTickSpacing"),N(Q,F,K.$11k,!0,!0,"_currentBottomMajorTickSpacing"),N(C,D,K.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(d,u,R,n,l){return R>d*n?d=N(u/n/l)*l:d*n>u&&(d=m(R/n/l)*l),d},getHTipText:function(v){var s=this,q=s._component,I=0,Z=s._view.getBoundingClientRect();return q.lp?I=K(q.lp({x:v.x+Z.left,y:v.y}).x):I-=K(this.getComponentView(q).style.left)||0,I},$9k:function(X,R,u,E,w,n,D,c,o,Z,l){var P=this,F=P._component;X.save(),U.translateAndScale(X,0,0,1);var f=R-(K(this.getComponentView(F).style.left)||0),g=0;if(R=P.getHTipText(P.$16k),n&&(X.beginPath(),X.fillStyle=E,X.rect(f,g,w,u),X.fill()),D){X.beginPath(),X.textAlign="center",X.textBaseline="middle",X.font=Z;var m=X.measureText(R).width+6;X.fillStyle=l,X.rect(f-m/2,g,m,u),X.fill(),X.strokeStyle=c,X.stroke(),X.beginPath(),X.fillStyle=o,X.fillText(R,f,g+u/2)}X.restore()},getVTipText:function(u){var f=this,$=f._component,q=0,r=f._view.getBoundingClientRect();return $.lp?q=K($.lp({x:u.x,y:u.y+r.top}).y):q-=K(this.getComponentView($).style.top)||0,q},formatScaleText:function(K){return Math.round(K)},$10k:function(s,x,i,W,v,n,g,l,$,r,I,u){var t=this,G=t._component;s.save(),U.translateAndScale(s,0,0,1);var R=i/2,F=x-(K(this.getComponentView(G).style.top)||0);if(x=t.getVTipText(t.$16k),n&&(s.beginPath(),s.fillStyle=W,s.rect(R-i/2,F,i,v),s.fill()),g){s.translate(R,F),s.rotate((u?90:-90)*k/180),s.translate(-R,-F),s.beginPath(),s.textAlign="center",s.textBaseline="middle",s.font=r;var L=s.measureText(x).width+6;s.fillStyle=I,s.rect(R-L/2,F-i/2,L,i),s.fill(),s.strokeStyle=l,s.stroke(),s.fillStyle=$,s.fillText(x,R,F)}s.restore()},$11k:function(v,f,H,o,k,E,D,w,Q,B,m,V,Y){v.save(),H=0;var X=f,d=o,s=(X+d)/2;f=0,o=d-X,U.translateAndScale(v,0,0,1);var P=0,h=0,A=K(E/2),r=E-A,c=m?0:A,i=w*D,O=i/10;f-=i,o+=i,v.clearRect(f,0,o-f,E),v.beginPath(),v.fillStyle=Y;var z=N(s/O)*O-X;for(P=z;o>P;P+=O)v.rect(P,H+c,1,r);for(P=z;P>f;P-=O)v.rect(P,H+c,1,r);for(v.fill(),c=m?0:1,v.beginPath(),v.fillStyle=V,z=N(s/i)*i-X,P=z;o>P;P+=i)v.rect(P,H+c,1,E-1);for(P=z;P>f;P-=i)v.rect(P,H+c,1,E-1);v.fill();var x=K(/\d+px/.exec(Q)[0]),L=(x||10)/2;v.textBaseline="middle",c=m?E-L-2:L+2,v.beginPath(),v.fillStyle=B,v.font=Q;var q=N(s/i)*i/D;for(P=z,h=q;o>P;P+=i,h+=w){var W=this.getHScaleText?this.getHScaleText(P):h;v.fillText(this.formatScaleText(W),P+2,H+c)}for(P=z,h=q;P>f;P-=i,h-=w){var W=this.getHScaleText?this.getHScaleText(P):h;v.fillText(this.formatScaleText(W),P+2,H+c)}v.restore()},$12k:function(X,H,g,P,T,q,E,L,j,G,w,Z,C){function u(N,y,R,U,Y,T){Y=I.getVScaleText?I.getVScaleText(R):Y,Y=I.formatScaleText(Y),X.translate(N+y,R),X.rotate(-U),X.translate(-N-y,-R),X.fillText(Y,N+y+(T?2:1),R),X.translate(N+y,R),X.rotate(U),X.translate(-N-y,-R)}X.save(),H=0;var r=g,v=T,B=(r+v)/2;g=0,T=v-r,U.translateAndScale(X,0,0,1);var A=0,I=this,i=0,$=K(q/2),f=q-$,x=w?0:$,_=L*E,a=_/10;g-=_,T+=_,X.clearRect(H,0,q,T-g),X.beginPath(),X.fillStyle=C;var t=N(B/a)*a-r;for(A=t;T>A;A+=a)X.rect(H+x,A,f,1);for(A=t;A>g;A-=a)X.rect(H+x,A,f,1);for(X.fill(),x=w?0:1,X.beginPath(),X.fillStyle=Z,t=N(B/_)*_-r,A=t;T>A;A+=_)X.rect(H+x,A,q-1,1);for(A=t;A>g;A-=_)X.rect(H+x,A,q-1,1);X.fill();var d=K(/\d+px/.exec(j)[0]),h=(d||10)/2,m=90*k/180;X.textBaseline="middle",x=w?q-h:h+2,m=w?-m:m,X.beginPath(),X.fillStyle=G,X.font=j;var M=N(B/_)*_/E;for(A=t,i=M;T>A;A+=_,i+=L)u(H,x,A,m,i,w);for(A=t,i=M;A>g;A-=_,i-=L)u(H,x,A,m,i,w);X.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var F=this,C=F._component,q=F._view;C&&F.removeComponentPropertyChangeListener(C,F.$14k),q&&(o(q,"mousemove",F.$15k),W(q.parentNode,q),F._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);