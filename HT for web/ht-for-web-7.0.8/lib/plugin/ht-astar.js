!function(f,y,V){"use strict";var L=f.ht;L.Astar={},function(c){var e=c();f.AStar=e.astar,f.AStar.Graph=e.Graph}(function(){function T(H){for(var j=H,a=[];j.parent;)a.unshift(j),j=j.parent;return a}function i(){return new K(function(d){return d.f})}function g(m,c){c=c||{},this.nodes=[],this.diagonal=!!c.diagonal,this.grid=[];for(var C=0;C<m.length;C++){this.grid[C]=[];for(var M=0,V=m[C];M<V.length;M++){var J=new W(C,M,V[M]);this.grid[C][M]=J,this.nodes.push(J)}}this.$13x()}function W(r,s,$){this.x=r,this.y=s,this.weight=$}function K(r){this.content=[],this.scoreFunction=r}var P={search:function(B,f,e,D){B.$6x(),D=D||{};var r=D.heuristic;r||(r=B.diagonal?P.$4x.diagonal:P.$4x.manhattan);var F=D.closest||!1,L=D.punish,O=i(),u=f;for(f.h=r(f,e),B.$7x(f),O.push(f);O.size()>0;){var M=O.pop();if(M===e)return T(M);M.closed=!0;for(var m=B.neighbors(M),I=0,K=m.length;K>I;++I){var l=m[I];if(!l.closed&&!l.$9x()){var h=M.g+l.getCost(M,L),o=l.visited;(!o||h<l.g)&&(l.visited=!0,l.parent=M,l.h=l.h||r(l,e),l.g=h,l.f=l.g+l.h,B.$7x(l),F&&(l.h<u.h||l.h===u.h&&l.g<u.g)&&(u=l),o?O.$10x(l):O.push(l))}}}return F?T(u):[]},$4x:{manhattan:function(I,Z){var _=Math.abs(Z.x-I.x),n=Math.abs(Z.y-I.y);return _+n},diagonal:function(D,k){var y=1,Y=Math.sqrt(2),w=Math.abs(k.x-D.x),d=Math.abs(k.y-D.y);return y*(w+d)+(Y-2*y)*Math.min(w,d)}},$5x:function(P){P.f=0,P.g=0,P.h=0,P.visited=!1,P.closed=!1,P.parent=null}};return g.prototype.$13x=function(){this.dirtyNodes=[];for(var F=0;F<this.nodes.length;F++)P.$5x(this.nodes[F])},g.prototype.$6x=function(){for(var W=0;W<this.dirtyNodes.length;W++)P.$5x(this.dirtyNodes[W]);this.dirtyNodes=[]},g.prototype.$7x=function(y){this.dirtyNodes.push(y)},g.prototype.neighbors=function(t){var $=[],l=t.x,V=t.y,H=this.grid;return H[l-1]&&H[l-1][V]&&$.push(H[l-1][V]),H[l+1]&&H[l+1][V]&&$.push(H[l+1][V]),H[l]&&H[l][V-1]&&$.push(H[l][V-1]),H[l]&&H[l][V+1]&&$.push(H[l][V+1]),this.diagonal&&(H[l-1]&&H[l-1][V-1]&&$.push(H[l-1][V-1]),H[l+1]&&H[l+1][V-1]&&$.push(H[l+1][V-1]),H[l-1]&&H[l-1][V+1]&&$.push(H[l-1][V+1]),H[l+1]&&H[l+1][V+1]&&$.push(H[l+1][V+1])),$},g.prototype.toString=function(){for(var x=[],i=this.grid,L=0;L<i.length;L++){for(var D=[],N=i[L],r=0;r<N.length;r++)D.push(N[r].weight);x.push(D.join(" "))}return x.join("\n")},W.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},W.prototype.getCost=function(q,A){var t;if(t=q&&q.x!=this.x&&q.y!=this.y?1.41421*this.weight:this.weight,A){var M=q;if(!M)return t;var p=M.parent;return p?Math.abs(p.x+this.x-2*M.x)>1e-5?t+A:Math.abs(p.y+this.y-2*M.y)>1e-5?t+A:t:t}},W.prototype.$9x=function(){return 0===this.weight},K.prototype={push:function(I){this.content.push(I),this.$11x(this.content.length-1)},pop:function(){var K=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.$12x(0)),K},remove:function(A){var Q=this.content.indexOf(A),O=this.content.pop();Q!==this.content.length-1&&(this.content[Q]=O,this.scoreFunction(O)<this.scoreFunction(A)?this.$11x(Q):this.$12x(Q))},size:function(){return this.content.length},$10x:function(Q){this.$11x(this.content.indexOf(Q))},$11x:function(o){for(var d=this.content[o];o>0;){var Z=(o+1>>1)-1,f=this.content[Z];if(!(this.scoreFunction(d)<this.scoreFunction(f)))break;this.content[Z]=d,this.content[o]=f,o=Z}},$12x:function(Q){for(var N=this.content.length,m=this.content[Q],$=this.scoreFunction(m);;){var Y,n=Q+1<<1,z=n-1,h=null;if(N>z){var A=this.content[z];Y=this.scoreFunction(A),$>Y&&(h=z)}if(N>n){var s=this.content[n],W=this.scoreFunction(s);(null===h?$:Y)>W&&(h=n)}if(null===h)break;this.content[Q]=this.content[h],this.content[h]=m,Q=h}}},{astar:P,Graph:g}});var i=L.Astar.Finder=function(g,b){var J=this;J.gv=g,J.$13x(b),J.refreshMap()};i.prototype={},i.prototype.constructor=i,y.defineProperties(i.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(m){this.gv._astarDebugInfo=m}}}),i.prototype.$13x=function(r){var g=this,M=g.$14x={};r=r||{};var T=r.gridSize||10;M.gridSizeX=r.gridSizeX||T,M.gridSizeY=r.gridSizeY||T,M.rect=r.rect,M.filter=r.filter,M.extendBlocks=r.extendBlocks||3,M.fastOverlap=r.fastOverlap===V?!0:r.fastOverlap,M.nodeRectExtend=r.nodeRectExtend||0,M.diagonal=r.diagonal===V?!0:r.diagonal,M.turnPunish=r.turnPunish===V?.1:r.turnPunish,M.simplify=r.simplify===V?!0:r.simplify,M.toGridCenter=r.toGridCenter===V?!1:r.toGridCenter,M.closest=r.closest===V?!0:r.closest},i.prototype.refreshMap=function(){var S,Y=this,E=Y.$14x,_=E.gridSizeX,A=E.gridSizeY,R=E.extendBlocks;E.rect?S=E.rect:(S=Y.$15x(),L.Default.grow(S,_*R,A*R)),L.Default.grow(S,_,A);var D=Math.floor(S.x/_)*_,b=Math.floor(S.y/A)*A,B=Math.ceil(S.width/_),P=Math.ceil(S.height/A),l=B*_,W=P*A;Y.$16x={x:D,y:b,w:l,h:W,gridX:_,gridY:A,xLen:B,yLen:P},Y.$17x(),Y.$21x()},i.prototype.$15x=function(){var Q=this.gv;if(Q instanceof L.graph.GraphView)return Q.getContentRect();var s,O=L.Default.unionRect;return Q.dm().each(function(j){Q.isVisible(j)&&j.getRect&&(s=O(s,j.getRect()))}),s},i.prototype.$17x=function(){var y,N,Q,e,q=this,b=q.$16x,K=b.xLen,d=b.yLen;for(y=new Array(K),Q=0;K>Q;Q++)for(y[Q]=N=new Array(d),e=d;e--;)N[e]=1;var i=q.$14x.filter;for(q.gv.dm().each(function(A){i&&i(A)===!1||(!q._debugInfo||A!==q._debugInfo.grid&&A!=q._debugInfo.path)&&q.$1cw(y,A)}),Q=0;K>Q;Q++)y[Q][0]=1,y[Q][d-1]=1;for(e=0;d>e;e++)y[0][e]=1,y[K-1][e]=1;q.grid=y;var s=new AStar.Graph(y,{diagonal:q.$14x.diagonal});q.graph=s},i.prototype.$18x=function(A,i,K,k,p,W,n,Y){var U=this.$19x,r=U(K-A,p-n,k-i,W-Y);if(1e-6>=r&&r>=-1e-6)return!1;var m=U(p-A,p-n,W-i,W-Y)/r;if(0>m||m>1)return!1;var G=U(K-A,p-A,k-i,W-i)/r;return 0>G||G>1?!1:!0},i.prototype.$19x=function(W,R,N,y){return W*y-R*N},i.prototype.$1aw=function(G,t,_,P){for(var E=[-(t[1]-G[1]),t[0]-G[0]],N=E[0]*(_[0]-G[0])+E[1]*(_[1]-G[1])>=0,o=0,I=P.length;I>o;o+=2)if(E[0]*(P[o]-G[0])+E[1]*(P[o+1]-G[1])>=0===N)return!1;return!0},i.prototype.$1bw=function(m,E){for(var F,N,X=this,D=0,z=m.length;z>D;D+=2)if(F=D===z-2?0:D+2,N=F===z-2?0:F+2,X.$1aw([m[D],m[D+1]],[m[F],m[F+1]],[m[N],m[N+1]],E))return!1;for(var D=0,z=E.length;z>D;D+=2)if(F=D===z-2?0:D+2,N=F===z-2?0:F+2,X.$1aw([E[D],E[D+1]],[E[F],E[F+1]],[E[N],E[N+1]],m))return!1;return!0},i.prototype.$1cw=function(D,Z){if(Z.getRect){var z=this,b=Z.getRect();L.Default.grow(b,z.$14x.nodeRectExtend);var f,O,K,r,P,g,v,H,V,_,y,h=z.$1dw({x:b.x,y:b.y}),a=z.$1dw({x:b.x+b.width,y:b.y+b.height}),d=z.$14x.fastOverlap;if(!d){var A=Z.getCorners();v=[],A.forEach(function(B){v.push(B.x,B.y)}),_=z.$14x.gridSizeX/2,y=z.$14x.gridSizeY/2}for(O=Math.max(0,h.x),K=Math.min(a.x,D.length-1),P=Math.max(0,h.y),g=Math.min(a.y,D.length?D[0].length-1:-1),f=O;K>=f;f++)for(r=P;g>=r;r++)if(d)D[f][r]=0;else{V=z.$1ew({x:f,y:r});var k=V.x-_,G=V.x+_,t=V.y-y,n=V.y+y;H=[k,t,k,n,G,n,G,t],z.$1bw(v,H)&&(D[f][r]=0)}}},i.prototype.$1dw=function(W,h){var A=this,s=A.$16x,Q=(W.x-s.x)/s.gridX,u=(W.y-s.y)/s.gridY;return h!==!1&&(Q=Math.round(Q),u=Math.round(u)),{x:Q,y:u}},i.prototype.$1ew=function(d){var M=this,P=M.$16x;return{x:d.x*P.gridX+P.x,y:d.y*P.gridY+P.y}},i.prototype.$1fw=function(k){var K=this,z=K.$16x,W=z.xLen,A=z.yLen;if(k.x>=0&&k.x<W&&k.y>=0&&k.y<A)return k;var Z={x:k.x,y:k.y};return Z.x<0?Z.x=0:Z.x>=W&&(Z.x=W-1),Z.y<0?Z.y=0:Z.y>=A&&(Z.y=A-1),Z},i.prototype.findPath=function(A,L){var B,x,e,D,c=this,Y=c.$1dw(A),b=c.$1dw(L);if(e=c.$1fw(Y),D=c.$1fw(b),e!==Y&&D!==b){var V=c.$16x,v=V.x-V.gridX/2,w=V.y-V.gridY/2,S=v+V.gridX*V.xLen,E=w+V.gridY*V.yLen;if(!(c.$18x(A.x,A.y,L.x,L.y,v,w,S,w)||c.$18x(A.x,A.y,L.x,L.y,S,w,S,E)||c.$18x(A.x,A.y,L.x,L.y,S,E,v,E)||c.$18x(A.x,A.y,L.x,L.y,v,E,v,w)))return[A,L]}e!==Y&&(B=!0,Y=e),D!==b&&(x=!0,b=D);var N=c.graph.grid[Y.x][Y.y],z=c.graph.grid[b.x][b.y],n=AStar.search(c.graph,N,z,{closest:c.$14x.closest,punish:c.$14x.turnPunish});if(!n||!n.length)return null;var m=[];m.push(A),B&&m.push(c.$1ew(n[0]));for(var q=1,R=n.length;R-1>q;q++)m.push(c.$1ew(n[q]));if(x)m.push(c.$1ew(n[R-1])),m.push(L);else{var P=n[R-1];b.x!==P.x||b.y!==P.y||c.$14x.toGridCenter?m.push(c.$1ew(P)):m.push(L)}return c.$14x.simplify&&(m=c.simplifyPath(m)),c.$20x=m,c.$21x(),m},i.prototype.debugOn=function(f){this.debugFlag=!0,this.debugSettings=f||{},this.$21x()},i.prototype.simplifyPath=function(Y){var v=Y.length;if(2>=v)return Y;var N,Z,$=[Y[0],Y[1]],b=$[0],U=$[1],m=1e-5;for(N=2;v>N;N++)Z=Y[N],Math.abs((U.x-b.x)*(Z.y-b.y)-(U.y-b.y)*(Z.x-b.x))<m?U=$[$.length-1]=Z:(b=U,U=Z,$.push(Z));return $},i.prototype.$21x=function(){var z=this;if(z.$22x(),this.debugFlag){var H=z.grid;if(H){var G,$=z.gv;if(z.debugSettings.$16x!==!1){G=[];for(var j,l,_,r,K,R=[],Y=z.$14x.gridSizeX/2,D=z.$14x.gridSizeY/2,I=H.length,S=I?H[0].length:0,t=1;I-1>t;t++)for(var h=1;S-1>h;h++)H[t][h]||(j=z.$1ew({x:t,y:h}),l=j.x-Y,_=j.x+Y,r=j.y-D,K=j.y+D,G.push({x:l,y:r},{x:l,y:K},{x:_,y:K},{x:_,y:r}),R.push(1,2,2,2,5));var m=new L.Shape;m.s("shape.border.color","rgba(50, 50, 50, 0.2)"),m.s("shape.border.width",1),m.s("shape.background","rgba(200, 50, 100, 0.2)"),m.s("2d.editable",!1),m.s("2d.selectable",!1),m.setPoints(G),m.setSegments(R),z._debugInfo={grid:m},$.dm().add(m)}z.debugSettings.path!==!1&&(G=new L.Shape,z.$20x&&(G.setPoints(z.$20x),G.s("shape.border.color","red"),G.s("shape.border.width",1),G.s("2d.editable",!1),G.s("2d.selectable",!1),G.s("shape.background",null),z._debugInfo||(z._debugInfo={}),z._debugInfo.path=G,$.dm().add(G)))}}},i.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},i.prototype.$22x=function(){var N=this;if(N._debugInfo){var K=N._debugInfo.grid,e=N._debugInfo.path,v=N.gv;K&&v.dm().remove(K),e&&v.dm().remove(e),N._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);